name: $CONTAINER_APP_NAME
location: eastus
resourceGroup: $RESOURCE_GROUP
environment: default

properties:
  template:
    containers:
      - image: $ACR_NAME.azurecr.io/$IMAGE_OTELCOL_NAME:$IMAGE_TAG
        name: otelcol
        
      - image: $ACR_NAME.azurecr.io/$IMAGE_LLMAPP_NAME:$IMAGE_TAG
        name: sk-financial-analyst-app
        probes:
        - type: Liveness
          httpGet:
            path: "/"
            port: 8000
          initialDelaySeconds: 3
          periodSeconds: 3
        initContainers:
        - image: $ACR_NAME.azurecr.io/$IMAGE_LLMAPP_NAME:$IMAGE_TAG
          name: sk-financial-analyst-app
          resources:
            cpu: 500m
            memory: 512Mi
          command:
          - "/bin/sh"
        scale:
          minReplicas: 1
          maxReplicas: 2
          rules:
          - name: httpscalingrule
            custom:
              type: http
              metadata:
                concurrentRequests: '50'